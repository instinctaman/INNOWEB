function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return i;o++}},configurable:!0,writable:!0}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;o<n;){var i=t[o];if(e.call(r,i,o,t))return o;o++}return-1},configurable:!0,writable:!0}),Array.from||(Array.from=function(){var e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},r=Math.pow(2,53)-1,o=function(e){var t=n(e);return Math.min(Math.max(t,0),r)};return function(e){var n=this,r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,a=arguments.length>1?arguments[1]:void 0;if("undefined"!=typeof a){if(!t(a))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(i=arguments[2])}for(var s,l=o(r.length),u=t(n)?Object(new n(l)):new Array(l),c=0;c<l;)s=r[c],a?u[c]="undefined"==typeof i?a(s,c):a.call(i,s,c):u[c]=s,c+=1;return u.length=l,u}}()),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){function n(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),o=r.length>>>0;if(0===o)return!1;for(var i=0|t,a=Math.max(i>=0?i:o-Math.abs(i),0);a<o;){if(n(r[a],e))return!0;a++}return!1}}),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,void(window.CustomEvent=e))}(),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1==t.nodeType);return null}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.lastIndexOf(e,t);return r!==-1&&r===t});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"use strict";function t(e){e=e||"",(e instanceof URLSearchParams||e instanceof t)&&(e=e.toString()),this[u]=i(e)}function n(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,function(e){return t[e]})}function r(e){return decodeURIComponent(e.replace(/\+/g," "))}function o(t){var n={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return f&&(n[e.Symbol.iterator]=function(){return n}),n}function i(e){var t={};if("object"===("undefined"==typeof e?"undefined":_typeof(e))){for(var n in e)if(e.hasOwnProperty(n)){var o="string"==typeof e[n]?e[n]:JSON.stringify(e[n]);a(t,n,o)}}else{0===e.indexOf("?")&&(e=e.slice(1));for(var i=e.split("&"),s=0;s<i.length;s++){var l=i[s],u=l.indexOf("=");-1<u?a(t,r(l.slice(0,u)),r(l.slice(u+1))):l&&a(t,r(l),"")}}return t}function a(e,t,n){t in e?e[t].push(""+n):e[t]=[""+n]}var s=e.URLSearchParams?e.URLSearchParams:null,l=s&&"a=1"===new s({a:1}).toString(),u="__URLSearchParams__",c=t.prototype,f=!(!e.Symbol||!e.Symbol.iterator);if(!s||!l){c.append=function(e,t){a(this[u],e,t)},c["delete"]=function(e){delete this[u][e]},c.get=function(e){var t=this[u];return e in t?t[e][0]:null},c.getAll=function(e){var t=this[u];return e in t?t[e].slice(0):[]},c.has=function(e){return e in this[u]},c.set=function(e,t){this[u][e]=[""+t]},c.toString=function(){var e,t,r,o,i=this[u],a=[];for(t in i)for(r=n(t),e=0,o=i[t];e<o.length;e++)a.push(r+"="+n(o[e]));return a.join("&")},e.URLSearchParams=s&&!l?new Proxy(s,{construct:function(e,n){return new e(new t(n[0]).toString())}}):t;var p=e.URLSearchParams.prototype;p.polyfill=!0,p.forEach=p.forEach||function(e,t){var n=i(this.toString());Object.getOwnPropertyNames(n).forEach(function(r){n[r].forEach(function(n){e.call(t,n,r,this)},this)},this)},p.sort=p.sort||function(){var e,t,n,r=i(this.toString()),o=[];for(e in r)o.push(e);for(o.sort(),t=0;t<o.length;t++)this["delete"](o[t]);for(t=0;t<o.length;t++){var a=o[t],s=r[a];for(n=0;n<s.length;n++)this.append(a,s[n])}},p.keys=p.keys||function(){var e=[];return this.forEach(function(t,n){e.push([n])}),o(e)},p.values=p.values||function(){var e=[];return this.forEach(function(t){e.push([t])}),o(e)},p.entries=p.entries||function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),o(e)},f&&(p[e.Symbol.iterator]=p[e.Symbol.iterator]||p.entries)}}("undefined"!=typeof global?global:"undefined"!=typeof window?window:void 0),function(e){function t(e){this.message=e}var n="undefined"!=typeof exports?exports:e,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",n.btoa||(n.btoa=function(e){for(var n,o,i=String(e),a=0,s=r,l="";i.charAt(0|a)||(s="=",a%1);l+=s.charAt(63&n>>8-a%1*8)){if(o=i.charCodeAt(a+=.75),o>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|o}return l}),n.atob||(n.atob=function(e){var n=String(e).replace(/=+$/,"");if(n.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var o,i,a=0,s=0,l="";i=n.charAt(s++);~i&&(o=a%4?64*o+i:i,a++%4)?l+=String.fromCharCode(255&o>>(-2*a&6)):0)i=r.indexOf(i);return l})}(window),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},o=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,o.prototype=new r,o}),"children"in document.documentElement||(Object.defineProperty(Element.prototype,"children",{get:function(){for(var e=[],t=this.firstChild;t;)1===t.nodeType&&e.push(t),t=t.nextSibling;return e}}),Object.defineProperty(HTMLElement.prototype,"children",{get:function(){for(var e=[],t=this.firstChild;t;)1===t.nodeType&&e.push(t),t=t.nextSibling;return e}})),"children"in document||Object.defineProperty(Document.prototype,"children",{get:function(){for(var e=[],t=this.firstChild;t;)return 1===t.nodeType&&(e.push(t),t=t.nextSibling),e}}),"classList"in document.documentElement||!Object.defineProperty||"undefined"==typeof HTMLElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function e(e){return function(n){var r=t.className.split(/\s+/),o=r.indexOf(n);e(r,o,n),t.className=r.join(" ")}}var t=this,n={add:e(function(e,t,n){t||e.push(n)}),remove:e(function(e,t){t&&e.splice(t,1)}),toggle:e(function(e,t,n){t?e.splice(t,1):e.push(n)}),contains:function(e){return!!~t.className.split(/\s+/).indexOf(e)},item:function(e){return t.className.split(/\s+/)[e]||null}};return Object.defineProperty(n,"length",{get:function(){return t.className.split(/\s+/).length}}),n}}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])}return n},writable:!0,configurable:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";function r(){}function o(e){try{return e.then}catch(t){return d=t,v}}function i(e,t){try{return e(t)}catch(n){return d=n,v}}function a(e,t,n){try{e(t,n)}catch(r){return d=r,v}}function s(e){if("object"!=_typeof(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._37=0,this._12=null,this._59=[],e!==r&&g(e,this)}function l(e,t,n){return new e.constructor(function(o,i){var a=new s(r);a.then(o,i),u(e,new m(t,n,a))})}function u(e,t){for(;3===e._37;)e=e._12;return 0===e._37?void e._59.push(t):void h(function(){var n=1===e._37?t.onFulfilled:t.onRejected;if(null===n)return void(1===e._37?c(t.promise,e._12):f(t.promise,e._12));var r=i(n,e._12);r===v?f(t.promise,d):c(t.promise,r)})}function c(e,t){if(t===e)return f(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==("undefined"==typeof t?"undefined":_typeof(t))||"function"==typeof t)){var n=o(t);if(n===v)return f(e,d);if(n===e.then&&t instanceof s)return e._37=3,e._12=t,void p(e);if("function"==typeof n)return void g(n.bind(t),e)}e._37=1,e._12=t,p(e)}function f(e,t){e._37=2,e._12=t,p(e)}function p(e){for(var t=0;t<e._59.length;t++)u(e,e._59[t]);e._59=null}function m(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function g(e,t){var n=!1,r=a(e,function(e){n||(n=!0,c(t,e))},function(e){n||(n=!0,f(t,e))});n||r!==v||(n=!0,f(t,d))}var h=e("asap/raw"),d=null,v={};t.exports=s,s._99=r,s.prototype.then=function(e,t){if(this.constructor!==s)return l(this,e,t);var n=new s(r);return u(this,new m(e,t,n)),n}},{"asap/raw":4}],2:[function(e,t,n){"use strict";function r(e){var t=new o(o._99);return t._37=1,t._12=e,t}var o=e("./core.js");t.exports=o;var i=r(!0),a=r(!1),s=r(null),l=r(void 0),u=r(0),c=r("");o.resolve=function(e){if(e instanceof o)return e;if(null===e)return s;if(void 0===e)return l;if(e===!0)return i;if(e===!1)return a;if(0===e)return u;if(""===e)return c;if("object"==("undefined"==typeof e?"undefined":_typeof(e))||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new o(t.bind(e))}catch(n){return new o(function(e,t){t(n)})}return r(e)},o.all=function(e){var t=Array.prototype.slice.call(e);return new o(function(e,n){function r(a,s){if(s&&("object"==("undefined"==typeof s?"undefined":_typeof(s))||"function"==typeof s)){if(s instanceof o&&s.then===o.prototype.then){for(;3===s._37;)s=s._12;return 1===s._37?r(a,s._12):(2===s._37&&n(s._12),void s.then(function(e){r(a,e)},n))}var l=s.then;if("function"==typeof l){var u=new o(l.bind(s));return void u.then(function(e){r(a,e)},n)}}t[a]=s,0===--i&&e(t)}if(0===t.length)return e([]);for(var i=t.length,a=0;a<t.length;a++)r(a,t[a])})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){e.forEach(function(e){o.resolve(e).then(t,n)})})},o.prototype["catch"]=function(e){return this.then(null,e)}},{"./core.js":1}],3:[function(e,t,n){"use strict";function r(){if(l.length)throw l.shift()}function o(e){var t;t=s.length?s.pop():new i,t.task=e,a(t)}function i(){this.task=null}var a=e("./raw"),s=[],l=[],u=a.makeRequestCallFromTimer(r);t.exports=o,i.prototype.call=function(){try{this.task.call()}catch(e){o.onerror?o.onerror(e):(l.push(e),u())}finally{this.task=null,s[s.length]=this}}},{"./raw":4}],4:[function(e,t,n){(function(e){"use strict";function n(e){s.length||(a(),l=!0),s[s.length]=e}function r(){for(;u<s.length;){var e=u;if(u+=1,s[e].call(),u>c){for(var t=0,n=s.length-u;n>t;t++)s[t]=s[t+u];s.length-=u,u=0}}s.length=0,u=0,l=!1}function o(e){var t=1,n=new f(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}function i(e){return function(){function t(){clearTimeout(n),clearInterval(r),e()}var n=setTimeout(t,0),r=setInterval(t,50)}}t.exports=n;var a,s=[],l=!1,u=0,c=1024,f=e.MutationObserver||e.WebKitMutationObserver;a="function"==typeof f?o(r):i(r),n.requestFlush=a,n.makeRequestCallFromTimer=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,t,n){"function"!=typeof Promise.prototype.done&&(Promise.prototype.done=function(e,t){var n=arguments.length?this.then.apply(this,arguments):this;n.then(null,function(e){setTimeout(function(){throw e},0)})})},{}],6:[function(e,t,n){e("asap"),"undefined"==typeof Promise&&(Promise=e("./lib/core.js"),e("./lib/es6-extensions.js")),e("./polyfill-done.js")},{"./lib/core.js":1,"./lib/es6-extensions.js":2,"./polyfill-done.js":5,asap:3}]},{},[6]),window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,40)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame),"undefined"==typeof webpublicationNamespace&&(window.webpublicationNamespace=window.w={Class:{},Main:{trackerManager:{trackPage:function(){},trackEvent:function(){}}},Param:{pathRoot:"publication/"},Utils:{}}),function(e){function t(){for(var e in r){this[e]={};for(var t=0;t<r[e].length;t++)this[e][r[e][t]]=this.defaultCall.bind(this,e,r[e][t])}}var n=[],r={common:["getValue","resolveValues","getDeviceInformation","getVersion","debugMode"],page:["getVisiblePages","getCount","addNewLink","removeLinkByID","open","openNext","openPrevious","shareSocial","openFirst","openLast","clickLink","clickButton","downloadPDF","print"],pagination:["getVerticalArrowPosition","setVerticalArrowsPosition"],configsJson:["getPageData","setPageData"],tab:["open"],navigator:["openUrl"],viewer:["changeMode","getCurrentMode","linkHandler"],content:["getContentURLByID","getContentAssetByID"],menu:["open","close","activate","desactivate"],lightbox:["open","openPopup","close","getOpenList","closeAll"],stat:["trackPage","trackEvent","trackCustomPage","trackCustomEvent"],event:["onPageChange"],styleSheet:[],panels:["share","search","favorites","thumbnail","summary"],gallery:["open","openAssetInApp","doActionInApp"]};window.apiActionScriptConfig={actionScriptApiMethod:"commonApiActionScriptCall",javaScriptNamespace:"webpublicationNamespace",javaScriptApiMethod:"NIApi.call",javaScriptEventMethod:"NIApi.event"},window.setExternalInterfaceIsReady=function(e){return NIApi.flashViewer=document.getElementById("Visio"),window.apiActionScriptInfo=e,window.externalInterfaceIsReady=!0,window.apiActionScriptConfig},window.addEventListener("message",function(e){if("string"==typeof e.data&&0===e.data.indexOf("api/")){for(var t=e.data.replace("api/","").split("/"),n=0;n<t.length;n++)t[n]=decodeURIComponent(t[n]);var r=t.shift().split("."),o=NIApi[r[0]][r[1]].apply(NIApi,t);e.source&&("event"===r[0]?e.source.postMessage({method:r.join("."),arguments:t,result:o},e.origin):o.then(function(n){e.source.postMessage({method:r.join("."),arguments:t,result:n},e.origin)}))}},!1),t.prototype.defaultCall=function(){var e=Array.prototype.slice.call(arguments);return new Promise(function(t,r){n.push({resolve:t,args:e})})},t.prototype.register=function(e,t){var n=e.split(".");this[n[0]][n[1]]=t;for(var r=this.getQueryList(),o=0;o<r.length;o++)r[o].args[0]===n[0]&&r[o].args[1]===n[1]&&(r[o].resolve(t.apply(this,r[o].args.splice(2))),r.splice(o,1))},t.prototype.call=function(t){return"flash"===e.Main.switcher.mode&&("event"===t.method&&"init"===t.args[0].type&&e.require(["../../global_conf/api_as3.js"]).then(function(){t.args[0].type="page";for(var e=0;e<t.args[0].visiblePages.length;e++)t.args[0].params.value=t.args[0].visiblePages[e].value,this.resolveActionScriptCall(t)}.bind(this)),this.resolveActionScriptCall?this.resolveActionScriptCall(t):void 0)},t.prototype.getFunctionList=function(){return r},t.prototype.getQueryList=function(){return n},e.Class.CommonApi=t,window.NIApi=new e.Class.CommonApi}(webpublicationNamespace);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){var t=!0;e.Utils._assertDebug=function(e){return e===!0?t=!0:e===!1&&(t=!1),t},e.Utils._assert=function(e,n){return e===!1&&t===!0&&console.error(n),e},e.Utils._assertInteger=function(t,n){return e.Utils._assert(t%1===0,n)},e.Utils._assertString=function(t,n){return e.Utils._assert("string"==typeof t,n)},e.Utils._assertBoolean=function(t,n){return e.Utils._assert("boolean"==typeof t,n)},e.Utils._assertJson=function(t,n){if(e.Utils._assert("string"==typeof t,n)){var r=!0;try{JSON.parse(t)}catch(o){r=!1}return e.Utils._assert(r,n)}return!1},e.Utils._assertObject=function(t,n){return e.Utils._assert("object"===("undefined"==typeof t?"undefined":_typeof(t)),n)},e.Utils._assertFunction=function(t,n){return e.Utils._assert("function"==typeof t,n)},e.Utils._assertOneOf=function(t,n,r){return e.Utils._assert(n.indexOf(t)>=0,r)},e.Utils.noop=function(){},e.Utils.callEvent=function(){return"CustomEvent"in window&&"function"==typeof window.CustomEvent?function(e,t,n){var r=new CustomEvent(t,{bubbles:!0,cancelable:!0});r.args=n,r&&e.dispatchEvent(r)}:function(e,t,n){var r;try{r=document.createEvent("HTMLEvents")}catch(o){r=document.createEvent("Event")}r.initEvent(t,!0,!0),r.bubbles=!0,r.args=n,r&&e.dispatchEvent(r)}}(),e.Utils.getPagesBetween=function(e,t){for(var n=[],r=e;r<=t;)n.push(r),r++;return n},e.Utils.getClosestByClass=function(e,t){do if(e.classList&&e.classList.contains(t)===!0)return e;while(null!==(e=e.parentNode));return!1},e.Utils.getClosestByAttribute=function(e,t){do{var n=!!e.attributes&&e.attributes.length;if(n&&n>0&&null!==e.getAttribute(t))return e}while(null!==(e=e.parentNode));return!1},e.Utils.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},e.Utils.promiseXHR=function(e,t,n,r,o){return r=r||null,new Promise(function(i,a){var s=new XMLHttpRequest;if(s.open(e,t,!0),o&&(s.withCredentials=!0),n instanceof Array)for(var l=0;l<n.length;l++)"undefined"!=typeof n[l]&&("resolve"===n[l].key&&(a=i),"overrideMimeType"===n[l].key?s.overrideMimeType(n[l].value):"Authorization"===n[l].key?(s.withCredentials=!0,s.setRequestHeader(n[l].key,"Basic "+btoa(n[l].username+":"+n[l].password))):s.setRequestHeader(n[l].key,n[l].value));s.onreadystatechange=function(){4===s.readyState&&(404===s.status?a(s):i(s))};try{s.send(r)}catch(u){a(s)}})},e.Utils.setCookie=function(e,t,n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var o="expires="+r.toUTCString();document.cookie=e+"="+t+"; "+o},e.Utils.resolveVariable=function(t){if(t&&"string"==typeof t){var n,r="",o="",i=t.match(/\$([A-Za-z0-9-_]+)\$/gi);if(i)for(n=0;n<i.length;n++)r=i[n].substring(1,i[n].length-1),o=e.Main.urlManager.get(r)||e.Main.xmlManager.getVariable(r),"transferring"===r&&e.Main.xmlManager.getVariable(r)&&(o=e.Main.xmlManager.getVariable(r)),"undefined"!=typeof o&&(t=t.replace(i[n],o));if(i=t.match(/\$\{\S+?\}/gi))for(n=0;n<i.length;n++)r=i[n].substring(2,i[n].length-1),o=e.Main.urlManager.get(r)||e.Main.xmlManager.getVariable(r),"transferring"===r&&e.Main.xmlManager.getVariable(r)&&(o=e.Main.xmlManager.getVariable(r)),"undefined"!=typeof o&&(t=t.replace(i[n],o));return t}if(t instanceof Array)return t.map(e.Utils.resolveVariable);if("object"===("undefined"==typeof t?"undefined":_typeof(t))){for(var a in t)t[a]=e.Utils.resolveVariable(t[a]);return t}return t},NIApi.register("common.resolveValues",function(t){return Promise.resolve(e.Utils.resolveVariable(t))}),NIApi.register("common.locale",function(t){return e.Main.xmlManager.get("locale",t)}),NIApi.register("common.getValue",function(t){return Promise.resolve(e.Main.xmlManager.getVariable(t))}),e.Utils.resolveTranslation=function(t){if(t&&"string"==typeof t){var n=t.match(/\#([A-Za-z0-9-_]+)\#/gi);if(n)for(var r="",o="",i=0;i<n.length;i++)r=n[i].substring(1,n[i].length-1),o=e.Main.xmlManager.get("locale",r),o&&(t=t.replace(n[i],o));return t}return""},e.Utils.resolveString=function(t){for(var n="",r=t;n!==r;)n=e.Utils.resolveTranslation(e.Utils.resolveVariable(r)),r=e.Utils.resolveTranslation(e.Utils.resolveVariable(n));return n},e.Utils.getFunctionName=function(e){var t="function"==typeof e,n=t&&(e.name&&["",e.name]||e.toString().match(/function ([^\(]+)/));return!t&&"not a function"||n&&n[1]||"anonymous"},e.Utils.hexToRgb=function(){function e(e){return parseInt(e.substring(0,2),16)}function t(e){return parseInt(e.substring(2,4),16)}function n(e){return parseInt(e.substring(4,6),16)}function r(e){return"#"===e.charAt(0)?e.substring(1):e}return function(o,i){o=r(o);var a=e(o),s=t(o),l=n(o);return"undefined"!=typeof i?(i=parseFloat(i),"rgba("+a+","+s+","+l+","+i+")"):"rgb("+a+","+s+","+l+")"}}(),e.Utils.whitelistParameters=function(t){var n=[e.Main.xmlManager.get("config","transferringVariable"),"bookmarks","bookmark","gallery","initState","lng","page","startPage","transferring","utm_campaign","utm_content","utm_medium","utm_source","utm_term"],r=document.createElement("a");r.href=t;var o=[],i=r.search.replace("?","");i=i.split("&");for(var a=0;a<i.length;a++){var s=i[a].split("=");n.indexOf(s[0])>=0&&o.push(i[a])}return r.search="?"+o.join("&"),r.href},e.Utils.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.Utils.scrollIntoView=function(){window.document.body.scrollIntoView(!0)},e.Utils.scrollIntoViewAsyn=function(){setTimeout(e.Utils.scrollIntoView,16),setTimeout(e.Utils.scrollIntoView,500),setTimeout(e.Utils.scrollIntoView,1e3)},e.Utils.supportsPassive=function(){var e;return function(){if("boolean"==typeof e)return e;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t)}catch(n){}return e}}()}(webpublicationNamespace),function(e){function t(t){return a.hasOwnProperty(t)===!1&&(a[t]=new Promise(function(n,r){i(t).then(function(t){e.Utils.promiseXHR("GET",t).then(function(r){n(!0),404!==r.status&&e.Main.cssManager.addLoaded([{url:t,text:r.responseText}])})["catch"](n)})})),a[t]}function n(e){return a.hasOwnProperty(e)===!1&&(a[e]=new Promise(function(t,n){i(e).then(function(e){var n=document.createElement("script");n.src=e,n.onload=t,n.onerror=t,document.head.appendChild(n)})})),a[e]}function r(t){return i(t).then(function(t){return e.Utils.promiseXHR("GET",t)})}var o={css:{},js:{},template:{}},i=function(){function t(e){var t=JSON.parse(e.responseText);for(var n in t.template)t.template[n]&&(o.template["publication/mobile/template/"+n+".html"]=t.template[n]);for(n in t.css)t.css[n]&&(o.css["css/"+n+".css"]=t.css[n]);for(n in t.js)t.js[n]&&(o.js["js/"+n+".js"]=t.js[n]);return Promise.resolve(o)}var n=null;return function(r){if(null===n){var i=e.Main.xmlManager.get("common-ui","assets","custom_template");n=i?e.Utils.promiseXHR("GET",e.Utils.resolveVariable("$template$template.json")).then(t)["catch"](function(){return Promise.resolve({css:{},js:{},template:{}})}):Promise.resolve({css:{},js:{},template:{}})}return n.then(function(){return r=r.replace(/^\.\//,""),r.indexOf(".css")!==-1?r=o.css[r]?o.css[r]:e.Main.xmlManager.getVariable("root")+"mobile/"+r:r.indexOf(".js")!==-1?r=o.js[r]?o.js[r]:e.Main.xmlManager.getVariable("root")+"mobile/"+r:r.indexOf(".html")!==-1&&o.template[r]&&(r=o.template[r]),r=e.Utils.resolveVariable(r),Promise.resolve(r)})}}(),a={};e.require=function(e){if("string"==typeof e)return r(e);for(var o=[],i=0,a=e.length;i<a;i++)0===e[i].indexOf("css/")?o.push(t(e[i]+".css")):0===e[i].indexOf("js/")?o.push(n(e[i]+".js")):e[i].indexOf(".js")!==-1?o.push(n(e[i])):e[i].indexOf(".css")!==-1&&o.push(t(e[i]));return Promise.all(o)},e.addCustomTemplate=function(e,t,n){o[e][t]=n}}(webpublicationNamespace),function(e){"use strict";function t(){this.init()}var n={};t.prototype.contains=function(e){return"undefined"!=typeof n[e]},t.prototype["delete"]=function(e){var t,n=!1,r=new RegExp("&?"+e+"=[^&]+"),o=location.search.match(r);o&&o[0]&&(t=location.href.replace(o[0],""),t=t.replace("?&","?"),history.replaceState(null,null,t),n=!0,location.href.indexOf("?")>-1&&""===location.search&&(t=location.href.replace("?",""),history.replaceState(null,null,t)));var i=location.hash.match(r);return i&&i[0]&&(t=location.href.replace(i[0],""),t=t.replace("?&","?"),history.replaceState(null,null,t),n=!0,location.href.indexOf("#")>-1&&("#"===location.hash||""===location.hash)&&(t=location.href.replace("#",""),history.replaceState(null,null,t))),n},t.prototype.forEach=function(e,t){for(var r in n)e.call(t||window,n[r],r,n)},t.prototype.get=function(e){return n[e]},t.prototype.getAll=function(){return n},t.prototype.init=function(e){n={};var t="",r="",o="",i="";if(0===location.search.indexOf("?")&&(t=location.search.slice(1)),t.length>0){o=t.split("&");for(var a=0;a<o.length;a++)o[a].indexOf("=")>0?(i=o[a].split("="),n[i[0]]=i[1]):n[o[a]]=!0}if(r="",0===location.hash.indexOf("#")&&(r=location.hash.slice(1)),r.length>0){o=r.split("&");for(var s=0;s<o.length;s++)o[s].indexOf("=")>0?(i=o[s].split("="),n[i[0]]=i[1]):n[o[s]]=!0}},t.prototype.set=function(e,t){var r=!1,o=location.hash.replace("#",""),i=o?o.split("&"):[],a=0;if(null===t){for(a=0;a<i.length;a++)i[a].split("=")[0]===e&&(i[a]=void 0,r=!0);delete n[e]}else{for(a=0;a<i.length;a++)i[a].split("=")[0]===e&&(i[a]=e+"="+t,r=!0);n[e]=t}r===!1&&i.push(e+"="+t),location.hash="#"+i.filter(function(e){return"undefined"!=typeof e}).join("&")},e.Class.UrlManager=t}(webpublicationNamespace),function(e){"use strict";var t=e.Class.CommonApi;t.prototype.dispatchEvent=function(t,n){"flash"===e.Main.switcher.mode?this.flashViewer[window.apiActionScriptConfig.javaScriptEventMethod](JSON.stringify({event:"lightbox.close",args:[{}]})):"html"===e.Main.switcher.mode&&this.javascriptviewer.dispatchEvent(t,n)},t.prototype.actionScriptCall=function(t){var n=window.apiActionScriptConfig.actionScriptApiMethod,r="[actionScriptCall]";return!!(e.Utils._assertObject(t,r+" The first argument must be an object")&&e.Utils._assertString(t.method,r+" The method key in arguments must be a string")&&e.Utils._assertFunction(this.flashViewer[n],r+" The method key in arguments must be a function"))&&JSON.parse(this.flashViewer[n](JSON.stringify(t)))},t.prototype.registerJavaScript=t.prototype.register,t.prototype.registerActionScript=t.prototype.register,e.Class.CommonApi=t}(webpublicationNamespace),function(e){"use strict";function t(){this.os={name:i,version:i},this.device={type:i},this.browser={name:i,version:i},p.call(this),this.device.type=this.getResolvedDeviceType(),c[this.os.name]&&(this.os.version=c[this.os.name]()),f[this.browser.name]&&(this.browser.version=f[this.browser.name]())}var n={IOS:"iOS",ANDROID:"android",BLACKBERRY:"blackberry",FIREFOX:"firefox",TIZEN:"tizen",WINDOWS:"windows",MAC:"mac",LINUX:"linux",CHROME_OS:"cros"},r={SAFARI:"safari",CHROME:"chrome",FIREFOX:"firefox",ANDROID:"android",TIZEN:"tizen",BLACKBERRY:"blackberry",IE:"ie",EDGE:"edge"},o={PHABLET:"phablet",TABLET:"tab",PHONE:"phone",DESKTOP:"desktop"},i="unknown",a=["android","blackberry","chrome","edge","firefox","ipad","iphone","linux","mac os","mobile","phone","safari","tablet","tizen","touch","trident","windows","cros"],s={},l=navigator.userAgent.toLowerCase();for(var u in a)s[a[u]]=l.indexOf(a[u])!==-1;var c={iOS:function(){return(/CPU.*OS ([0-9]{1,5})/i.exec(navigator.userAgent)||["",i])[1]},android:function(){return(/Android ([0-9.]+)/i.exec(navigator.userAgent)||["",i])[1]},windows:function(){var e=(/Windows Phone ([0-9.]+)/i.exec(navigator.userAgent)||["",i])[1];if(e!==i)return e;var t=(/Windows NT ([0-9.]+)/i.exec(navigator.userAgent)||["",i])[1];switch(t){case"10.0":return"10";case"6.3":return"8.1";case"6.2":return"8";case"6.1":return"7";case"6.0":return"Vista";case"5.2":case"5.1":return"XP";case"5.0":return"2000";default:return i}},mac:function(){var e=/Mac OS.* ([0-9_]+)/i.exec(navigator.userAgent);return e[1]?e[1].split("_").slice(0,2).join("."):i}},f={chrome:function(){return parseInt((/Chrome\/([0-9]+)/.exec(navigator.userAgent)||["",i])[1])},firefox:function(){return parseInt((/Firefox\/([0-9]+)/.exec(navigator.userAgent)||["",i])[1])},ie:function(){var e=(/rv\:([0-9]+)/.exec(navigator.userAgent)||["",i])[1];return e===i&&(e=(/IEMobile\/([0-9]+)/.exec(navigator.userAgent)||["",i])[1]),e===i&&(e=(/MSIE\s([0-9]+)/.exec(navigator.userAgent)||["",i])[1]),parseInt(e,10)},edge:function(){var e=(/Edge\/([0-9]+)\./.exec(navigator.userAgent)||["",i])[1];return parseInt(e,10)},safari:function(){return parseFloat((/Version\/([0-9]+\.[0-9]+)/.exec(navigator.userAgent)||["",i])[1])}},p=function(){var t=Math.max(e.Param.viewBody.getBoundingClientRect().width,e.Param.viewBody.getBoundingClientRect().height);if((s.iphone||s.ipad)&&!s.trident)return this.os.name=n.IOS,this.device.type=o.TABLET,this.browser.name=r.SAFARI,void(s.iphone?this.device.type=o.PHONE:t<750&&(this.device.type=o.PHABLET));if(s["mac os"]&&!s.trident){this.os.name=n.MAC,this.device.type=o.DESKTOP;var i=navigator.maxTouchPoints>0;return i&&(this.os.name=n.IOS,this.device.type=o.PHONE,t>750&&(this.device.type=o.TABLET)),void(s.chrome?this.browser.name=r.CHROME:s.firefox?this.browser.name=r.FIREFOX:this.browser.name=r.SAFARI)}return s.windows&&(this.os.name=n.WINDOWS,s.edge?(this.os.name=n.WINDOWS,this.browser.name=r.EDGE):s.chrome?this.browser.name=r.CHROME:s.firefox?this.browser.name=r.FIREFOX:this.browser.name=r.IE,s.mobile||s.phone?this.device.type=o.PHONE:this.device.type=o.DESKTOP),s.linux&&(this.os.name=n.LINUX,s.chrome?this.browser.name=r.CHROME:s.firefox&&(this.browser.name=r.FIREFOX),this.device.type=o.DESKTOP),s.tizen?(this.os.name=n.TIZEN,void(this.browser.name=r.TIZEN)):s.blackberry?(this.os.name=n.BLACKBERRY,void(this.browser.name=r.BLACKBERRY)):(s.android&&!s.trident?(this.os.name=n.ANDROID,this.device.type=o.TABLET,s.chrome?this.browser.name=r.CHROME:s.firefox?this.browser.name=r.FIREFOX:this.browser.name=r.ANDROID):s.firefox&&(s.mobile||s.tablet)&&(this.os.name=n.FIREFOX,this.browser.name=r.FIREFOX),s.mobile?this.device.type=o.PHONE:this.device.type!==o.DESKTOP&&(t/window.devicePixelRatio<750?this.device.type=o.PHABLET:t/window.devicePixelRatio<=1280?this.device.type=o.TABLET:this.device.type=o.DESKTOP),s.cros?(this.os.name=n.CHROME_OS,void(this.browser.name=r.CHROME)):void 0)};t.prototype.getResolvedDeviceType=function(){var e=new URLSearchParams(window.location.search),t=e.get("deviceType");return t?t:this.device.type},t.prototype.isDesktop=function(){return this.device.type===o.DESKTOP},t.prototype.isPhone=function(){return this.device.type===o.PHONE;
},t.prototype.isTablet=function(){return this.device.type===o.TABLET||this.device.type===o.PHABLET},t.prototype.isPhablet=function(){return this.device.type===o.PHABLET},t.prototype.isUnknown=function(){return this.device.type===i},t.prototype.isIE=function(){return this.browser.name===r.IE},t.prototype.OS=n,t.prototype.BROWSER=r,t.prototype.FORMAT=o,t.prototype.UNKNOWN=i,e.Class.UserAgentManager=t}(webpublicationNamespace),function(e){"use strict";function t(){}var n={},r={_comments:function(e){return e.replace(/<\!\-\-[^>]*\-\-\>/gim,"")},_default:function(e){return e.replace(/\{\{default\((.*?),\s*(.*?)\)\}\}/g,function(e,t,n){return"<% if ( typeof( "+t+' ) === "undefined" ) { var '+t+" = "+n+" } %>"})},_exists:function(e){return e.replace(/\{\{\s*exists\s*(.*?)\s*\}\}/g,function(e,t){return"<% if ( typeof( "+t+') !== "undefined" ) {  %>'}).replace(/\{\{\s*otherwise\s*\}\}/g,function(){return"<% } else { %>"}).replace(/\{\{\s*\/exists\s*\}\}/g,"<% } %>")},_if:function(e){return e.replace(/\{\{\s*(else|if)(.*?)\s*\}\}/g,function(e,t,n){return"if"===t?"<% if("+n+") { %>":""===n&&"else"===t?"<% } else { %>":"else"===t?"<% } else if("+n+") { %>":void 0}).replace(/\{\{\s*\/if\s*\}\}/g,"<% } %>")},_each:function(e){return e.replace(/\{\{\s*each\((.*?),(.*?)\)\s*(.*?)\s*\}\}/g,function(e,t,n,r){return"<% for(var "+t+" in "+r+") { if("+r+" instanceof Array) {"+t+" = parseInt("+t+", 10);} var "+n+" = "+r+"["+t+"]; %>"}).replace(/\{\{\s*\/each\s*\}\}/g,"<% } %>")},_webpublicationNamespace:function(e){return e.replace(/([^a-zA-Z0-9])w\./gi,"$1webpublicationNamespace.")},_ie:function(e){return e.replace(/([0-9a-z_]+)Plugin/gi,"obj.$1Plugin")},_var:function(e){return e=e.replace(/(\r\n|\n|\r)/gm," "),e.replace(/\{\{(.*?)\}\}/g,"<%=$1%>").replace(/\s+/g," ")}},o={},i={},a={icons:function(t){for(var n=t.querySelectorAll(".svgicon svg"),r=n.length;r--;)n[r].getAttribute("data-color")&&e.Utils.svgIcon(n[r],{icon:n[r].getAttribute("data-icon"),color:n[r].getAttribute("data-color")})},focusable:function(){var t=function(t){var n=t.target,r=e.Utils.getClosestByClass(n,"focusable");r!==!1&&(r.classList.add("focused"),window.setTimeout(function(){r.classList.remove("focused")},300))};return function(e){for(var n=e.querySelectorAll(".focusable"),r=n.length;r--;)n[r].addEventListener("vclick",t)}}(),template:function(){var t=function(t,n,r){return u(e.Utils.getTemplate("component",n),r).then(function(e){for(var o=e.length,a=t.parentNode,s=0;s<o;s++)i[n]&&i[n].call(e[s],r,n),null!==a&&e[s]?a.insertBefore(e[s],t):e[s]&&(t=e[s]),window.setTimeout(function(){this.onTemplateInserted&&this.onTemplateInserted()}.bind(e[s]),10);null!==a&&a.removeChild(t)})};return function(n){for(var r=n.querySelectorAll(".templateManagerPlaceholder"),o=[],i=0;i<r.length;i++)if(null!==r[i].parentNode){var a=r[i].getAttribute("data-template"),s=JSON.parse(r[i].getAttribute("data-data")),l=e.require(["js/component/"+a,"css/component/"+a]).then(t.bind(this,r[i],a,s));o.push(l)}return Promise.all(o)}}()},s=function(e,t){for(var n=[],r=0,o=function(){if(--r<=0)for(var e=0;e<n.length;e++){var o=document.createElement("script");o.type="text/javascript",o.innerHTML=n[e],t.appendChild(o)}},i=function(e){if(e.src){var i=document.createElement("script");i.type="text/javascript",i.src=e.src,i.onload=o,r++,t.appendChild(i)}else n.push(e.innerHTML);e.outerHTML=""},a=function(e){var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.href=e.href,t.appendChild(n),e.outerHTML=""},s=e.length,l=0;l<s;l++){if(e[l].getElementsByTagName){for(var u=e[l].getElementsByTagName("script"),c=0;c<u.length;c++)i(u[c]);"SCRIPT"===e[l].tagName&&i(e[l]);for(var f=e[l].getElementsByTagName("link"),p=0;p<f.length;p++)a(f[p]);"LINK"===e[l].tagName&&a(e[l])}t.appendChild(e[l]),window.setTimeout(function(){this.onTemplateInserted&&this.onTemplateInserted()}.bind(e[l]),10)}return e},l=function(e){for(var t in r)e=r[t](e);return new Function("obj","var w=webpublicationNamespace;var p=[];with(obj){p.push('"+e.replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"',$1,'").split("<%").join("');").split("%>").join("p.push('")+"');}return p.join('');")},u=function(t,n,r){n=n||{},"String"===e.Utils.getFunctionName(n.constructor)&&(n={content:n});for(var i in o)n[i+"Plugin"]=o[i];return Promise.resolve(c(t)).then(f.bind(this,t,n,r))},c=function(t){return"undefined"==typeof n[t]&&(n[t]=e.require(t).then(function(e){return Promise.resolve(l(e.responseText))})),n[t]},f=function(e,t,n,r){var o="div";t&&t.useTr===!0&&(o="table");var i=document.createElement(o);i.id="tmplWrapper",i.innerHTML=r(t),"table"===o&&(i=i.getElementsByTagName("tr")[0].parentNode);var s=[];if(i.querySelectorAll)for(var l in a)s.push(a[l](i,n));return Promise.all(s).then(function(){var t=[],n=i.childNodes.length,r=!1;for(e.indexOf("component")!==-1&&(r=e.replace(".html","").split("/"),r=r[r.length-1]);n--;){var o=i.childNodes[n];3===o.nodeType&&""===o.textContent.trim()||t.unshift(o)}return Promise.resolve(t)})},p=function(e,t){for(var n=e.length;n--;)t.parentNode.insertBefore(e[n],t),window.setTimeout(function(){this.onTemplateInserted&&this.onTemplateInserted()}.bind(e[n]),10);return e},m=function(e,t){for(var n=e.length;n--;)t.insertBefore(e[n],t.firstChild),window.setTimeout(function(){this.onTemplateInserted&&this.onTemplateInserted()}.bind(e[n]),10);return e},g=function(e,t){var n=null;n=t instanceof Node?t:t[0];for(var r=0;r<e.length;r++)n.parentNode.insertBefore(e[r],n),window.setTimeout(function(){this.onTemplateInserted&&this.onTemplateInserted()}.bind(e[r]),10);if(t instanceof Node)t.parentNode.removeChild(t);else for(var o=0;o<t.length;o++)t[o].parentNode.removeChild(t[o]);return e};t.addCallback=function(e,t){a[e]=t},t.addComponent=function(e,t){i[e]=t},t.addPlugin=function(e,t){o[e]=t},t.getPlugin=function(){return o},t.getComponentScript=function(){return i},t.getCache=function(){return n},t.prototype.load=function(t,n,r){return u(t,r,n).then(function(t){return e.Utils.empty(n),s(t,n)})},t.prototype.loadAppend=function(e,t,n){return u(e,n,t).then(function(e){return s(e,t)})},t.prototype.loadPrepend=function(e,t,n){return u(e,n,t).then(function(e){return m(e,t)})},t.prototype.loadBefore=function(e,t,n){return u(e,n,t).then(function(e){return p(e,t)})},t.prototype.loadReplace=function(e,t,n){return u(e,n,t).then(function(e){return g(e,t)})},e.Class.TemplateManager=t,e.Class.TemplateManager.addPlugin("escape",function(e){if(e)return e.replace("'","\\'")}),e.Class.TemplateManager.addPlugin("locale",function(t){return e.Utils.prodTools.getWordLangueByIndex(t)}),e.Class.TemplateManager.addPlugin("icon",function(t,n,r,o){var i=document.createElement("div");if(i.className="svgicon-new svgicon-"+t+" "+n,o)for(var a in o)i.setAttribute(a,o[a]);return e.Utils.svgIcon(i,{icon:t,color:r||null}),i.outerHTML}),e.Class.TemplateManager.addPlugin("encode",function(e){if(isNaN(e))return encodeURIComponent(e)}),e.Class.TemplateManager.addPlugin("template",function(e,t){var n="div";return t&&t.useTr===!0&&(n="tr"),t=t?JSON.stringify(t).replace(/"/g,"&quot;").replace(/\{/g,"&#123;").replace(/\}/g,"&#125;"):"{}","<"+n+' class="templateManagerPlaceholder" data-template="'+e+'" data-data="'+t+'"></'+n+">"}),e.Class.TemplateManager.addPlugin("hexToRgba",function(t,n){return n=parseFloat(n)/100,e.Utils.hexToRgb(t,n)})}(webpublicationNamespace);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"use strict";function t(){}var n,r,o=[];t.prototype.execute=function(t,o){if(r=o,n=e.Main.xmlManager.getVariable("transferring"),"undefined"==typeof n)return Promise.resolve();var i=new e.Class.QueryManager,a=t.querySelector("proxy");return a?i.execute(a).then(function(e){return r.transferring=e,Promise.resolve(e)}).then(i.execute.bind({},t)).then(this.parseData):i.execute(t).then(this.parseData)},t.prototype.parseData=function(){function e(t,n){for(var i in n)"object"===_typeof(n[i])&&n[i]instanceof Array==!1?e(t+"_"+i,n[i]):(r[t+"_"+i]=n[i],o.push(t+"_"+i))}return function(t){return e("transferring",t),r.transferring=n,Promise.resolve()}}(),t.prototype.remove=function(){localStorage&&localStorage.removeItem("transferring");for(var t in r)0===t.indexOf("transferring")&&delete r[t];return e.Main.urlManager["delete"]("transferring")},e.Class.TransferringManager=t}(webpublicationNamespace),function(e){"use strict";function t(e,t){for(var n=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),r=[],o=[],i=!1,a=0,s=null;null!==(s=n.exec(e));){var l=s[1];l.length&&l!==t&&(r.push({}),i=!0,a=0);var u;u=s[2]?s[2].replace(new RegExp('""',"g"),'"'):s[3],i===!1?o.push(u):r[r.length-1][o[a]]=u,a++}return r}function n(n,r){var o=t(r.trim(),n.getAttribute("separator")||","),i=n.querySelector("matchingProp");if(i){var a=e.Main.xmlManager.getVariable("transferring")||e.Main.urlManager.get("transferring");return o.filter(function(e){return e[i.getAttribute("id")]===a})[0]}return o}function r(e,t){var n=JSON.parse(t),r=e.querySelector("matchingProp");return r?n[r.getAttribute("id")]:n}function o(){}o.prototype.execute=function(t){var o,i=Array.prototype.filter.call(t.childNodes,function(e){return"dataset"===e.nodeName})[0],a=Array.prototype.filter.call(t.childNodes,function(e){return"url"===e.nodeName})[0],s=Array.prototype.filter.call(t.childNodes,function(e){return"asset"===e.nodeName})[0],l=i.getAttribute("type");a?o=a.textContent:s&&(o=e.Main.xmlManager.get("common-ui","assets",s.getAttribute("id")),o=o.hasOwnProperty("url")?o.url:o);var u=[];return a&&a.hasAttribute&&a.hasAttribute("username")&&a.hasAttribute("password")&&u.push({key:"Authorization",username:a.getAttribute("username"),password:a.getAttribute("password")}),e.Utils.promiseXHR("GET",e.Utils.resolveVariable(o),u).then(function(e){var t=null;return"JSON"===l?t=r(i,e.responseText):"CSV"===l&&(t=n(i,e.responseText)),Promise.resolve(t)})},e.Class.QueryManager=o}(webpublicationNamespace),function(e){"use strict";function t(){}var n={},r={},o={pubinfo:{},contents:{},template:{},locale:{},"common-ui":{},"common-configuration":{},summary:{},statistics:{get:function(){return null}},comboPages:{scrollablePages:[],forcedSinglePages:[],get:function(){return[]}}},i={pubinfo:function(e){"https:"===location.protocol&&(n.managerHost=(n.managerHost||n.manager_host).replace("http:","https:").replace(":80",":443")),o.pubinfo.template=null,o.pubinfo.contents=null,o.pubinfo.statistics="publication/contents/statistics.xml";for(var t=e.documentElement.childNodes,r=0;r<t.length;r++)"template"===t[r].tagName?o.pubinfo.template=this.resolver(t[r].getAttribute("url")):"contents"===t[r].tagName?o.pubinfo.contents=this.resolver(t[r].getAttribute("url")):"statistics"===t[r].tagName&&(o.pubinfo.statistics=this.resolver(t[r].getAttribute("url")));n.root="publication/",o.pubinfo.get=function(e){return o.pubinfo[e]}},contents:function a(t){var a=t.querySelector("contents");o.contents.config={pages_nr:parseInt(a.getAttribute("pages_nr")),shift:parseInt(a.getAttribute("shift")),prefix:a.getAttribute("prefix"),padding:parseInt(a.getAttribute("padding"))},NIApi.register("page.getCount",function(){return Promise.resolve(e.Main.xmlManager.get("common-configuration","config","pageCount"))}),o.contents.content={};for(var n=t.querySelectorAll("contents > content"),r=0;r<n.length;r++){var i=n[r].getAttribute("id").toLowerCase();o.contents.content[i]={id:i,width:parseInt(n[r].getAttribute("width")),height:parseInt(n[r].getAttribute("height")),path:this.resolver(n[r].getAttribute("path")),type:n[r].getAttribute("type"),ext:n[r].getAttribute("ext"),prefix:n[r].getAttribute("prefix")}}o.contents.get=function(e,t){if("undefined"!=typeof t)return o.contents.content[e][t];switch("thumbnails"===e&&o.contents.content.thumbnails_xdpi&&window.devicePixelRatio>=2&&(e="thumbnailsxdpi"),e){case"thumbnails_xdpi":e="thumbnailsxdpi";break;case"zoom_hd":e="zoomhd";break;case"full_pdf":e="fullPdf";break;default:e=e}if("undefined"==typeof o.contents.content[e])return null;var n="";return o.contents.content[e].prefix&&(n+=o.contents.content[e].prefix),o.contents.content[e].ext&&(n+="."+o.contents.content[e].ext),o.contents.content[e].path+n}},template:function(t){var n=t.querySelector("configs"),r=n.querySelector("preloader");o.template.configs={preloader:{wait_animation_preload:r.getAttribute("wait_animation_preload"),backgroundColor:r.getAttribute("backgroundColor"),progressColor:r.getAttribute("progressColor"),totalSizeColor:r.getAttribute("totalSizeColor")}},o.template.asset={};for(var i=t.querySelectorAll("assets > asset"),a=0;a<i.length;a++){var s=i[a].getAttribute("id");"custom_javascript"===s?(o.template.asset[s]=o.template.asset[s]||[],o.template.asset[s].push({id:s,url:this.resolver(i[a].getAttribute("url")),type:i[a].getAttribute("type"),appdom:i[a].getAttribute("appdom")})):o.template.asset[s]={id:s,url:this.resolver(i[a].getAttribute("url")),type:i[a].getAttribute("type"),appdom:i[a].getAttribute("appdom")},"locale"===s&&(o.template.asset.localeFlash={id:s,url:this.resolver(i[a].getAttribute("url")),type:i[a].getAttribute("type"),appdom:i[a].getAttribute("appdom")})}o.template.asset.localeHtml||(o.template.asset.localeHtml=o.template.asset.locale,o.template.asset.localeHtml.url="publication/locale/mobile/messages_"+e.Main.xmlManager.getVariable("locale")+".xml"),o.template.asset.css_html5&&o.template.asset.css_html5.url.indexOf("flash")!==-1&&(o.template.asset.css_html5={url:null}),o.template.get=function(e,t){return o.template.asset[e]?o.template.asset[e]:null},o.template.getConfig=function(e,t){return o.template.configs[e][t]}},locale:function(e){o.locale.messages=o.locale.messages||{};for(var t=e.querySelectorAll("message"),n=0;n<t.length;n++)o.locale.messages[t[n].getAttribute("id")]=t[n].textContent;o.locale.get=function(e){return o.locale.messages[e]}},localeFlash:function(e){o.locale.messages=o.locale.messages||{};for(var t=e.querySelectorAll("message"),n=0;n<t.length;n++)"undefined"==typeof o.locale.messages[t[n].getAttribute("id")]&&(o.locale.messages[t[n].getAttribute("id")]=t[n].textContent);for(var r=e.querySelectorAll("string"),i=0;i<r.length;i++)"undefined"==typeof o.locale.messages[r[i].getAttribute("name")]&&(o.locale.messages[r[i].getAttribute("name")]=r[i].textContent)},"common-ui":function(){function t(t){var n=!1,r=t.querySelector("menu_config");if(r){o["common-ui"].menu={left:[],center:[],right:[],burger:[]},o["common-ui"].menuViewControlItems=null;var i,a,s,l,u=["left","center","right","burger"],c=["default"];e.Param.isDesktop?c.push("desktop"):e.Param.isTablet?c.push("tablet"):c.push("mobile");var f=function(e){var t={};t.xmlElement=e,t.xmlString=e.outerHTML,void 0===t.xmlString&&(t.xmlString=(new XMLSerializer).serializeToString(e)),t.attributes={};for(var n=0;n<e.attributes.length;n++){var r=["label"],o=r.includes(e.attributes[n].name);o||(t.attributes[e.attributes[n].name]=e.attributes[n].value)}var i=e.querySelector("file");return i&&(t.file={image:i.getAttribute("url"),noMargin:i.getAttribute("noMargin"),url:i.getAttribute("href"),scale:i.getAttribute("scale")}),t},p=function(e){for(var t={},n=0;n<e.attributes.length;n++)t[e.attributes[n].name]=e.attributes[n].value;t.textContent="";try{t.textContent=e.textContent.trim()}catch(r){}return t},m=function(e){return Array.prototype.slice.call(e.querySelectorAll("element")).map(function(e){return"home"===e.getAttribute("name")&&(n=!0),f(e)})},g=function(e){return Array.prototype.slice.call(e.querySelectorAll("module")).map(function(e){return p(e)})},h=function(e,n,r,o,c){var p=e.querySelector("mode[name='"+n+"']");if(p){for(a in u)i=p.querySelector("menu[name='menu-"+u[a]+"']"),i?r[u[a]]=m(i):r[u[a]]=[];s=p.querySelector("panel_view_control"),s&&(o=f(s),o.children=m(s))}return l=t.querySelector("modules"),l&&(p=l.querySelector("mode[name='"+n+"']"),l&&p&&(c=g(p))),c},d=[],v=null,y=[];for(var b in c)y=h(r,c[b],d,v,y);if(e.Main.urlManager.get("backHome")&&n===!1){var w=document.createElement("element");w.setAttribute("name","home"),d.right.push(f(w))}o["common-ui"].menu=d,o["common-ui"].panelViewControlItems=v,o["common-ui"].modules=y}}function r(t){o["common-ui"].assets={custom_css:[]};for(var n=t.querySelectorAll("template > asset"),r=0;r<n.length;r++){var i=n[r].getAttribute("name");"custom_javascript"===i||"custom_css"===i?(o["common-ui"].assets[i]=o["common-ui"].assets[i]||[],o["common-ui"].assets[i].push({name:i,url:n[r].getAttribute("url")})):o["common-ui"].assets[i]={name:i,url:n[r].getAttribute("url")},"locale"===i&&(o["common-ui"].assets.localeFlash={name:i,url:n[r].getAttribute("url")})}o["common-ui"].assets.localeHtml||(o["common-ui"].assets.localeHtml=o["common-ui"].assets.locale,o["common-ui"].assets.localeHtml.url="publication/locale/mobile/messages_"+e.Main.xmlManager.getVariable("locale")+".xml")}function i(e){o["common-ui"].services={};for(var t=e.querySelectorAll("services > service"),n=0;n<t.length;n++){var r=t[n].getAttribute("id");o["common-ui"].services[r]={};for(var i=0;i<t[n].attributes.length;i++){var a=t[n].attributes[i];o["common-ui"].services[r][a.name]=a.value}}}function a(t){var r=function(e,t,n){var r=o["common-ui"][e];return t?(r=r[t],n&&r?r[n]:r?r:null):r?r:null},i=function(e){o["common-ui"].configs.deepLinking=!0;var t=e.querySelector("configs > deep_linking");t&&"true"!==t.getAttribute("value")&&(o["common-ui"].configs.deepLinking=!1)},a=function(t){o["common-ui"].configs.cookie={enabled:!0,url:void 0};var n=t.querySelector("configs > cookie");n&&(n.getAttribute("enabled")&&(o["common-ui"].configs.cookie.enabled="true"===n.getAttribute("enabled")),n.getAttribute("url")&&(o["common-ui"].configs.cookie.url=n.getAttribute("url")),n.getAttribute("gdpr")&&(o["common-ui"].configs.cookie.gdpr="true"===n.getAttribute("gdpr")),o["common-ui"].configs.cookie.services=e.Main.xmlManager.getConsentServices(n))},s=function(e){o["common-ui"].configs.tooltip={delay:300};var t=e.querySelector("configs > tooltip");t&&t.getAttribute("delay")&&(o["common-ui"].configs.tooltip.delay=~~t.getAttribute("delay"))},l=function(t){var n=t.querySelector("configs > page_layout");e.Main.pageLayoutService=new e.Class.PageLayoutService(n)},u=function(e){var t=e.querySelector("configs > pdf_html_font_max_load");t?o["common-ui"].configs.pdfHTMLMaxFontLoad=~~t.getAttribute("value")||0:o["common-ui"].configs.pdfHTMLMaxFontLoad=0},c=function(t){var n=t.querySelector("configs > viewer");e.Main.viewerService=new e.Class.ViewerService(n)},f=function(t){var n=t.querySelector("configs > thumbnails");e.Main.thumbnailsService=new e.Class.ThumbnailsService(n)},p=function(e){var t=e.querySelector("configs > links");o["common-ui"].configs.links={},t&&(o["common-ui"].configs.links.mode=t.getAttribute("mode"),t.hasAttribute("duration")&&(o["common-ui"].configs.links.duration=parseInt(t.getAttribute("duration"),10)))},m=function(e){o["common-ui"].configs.chapters=[];for(var t=e.querySelectorAll("configs > chapters > element"),n=0;n<t.length;n++){for(var r=t[n],i={},a=0;a<r.attributes.length;a++){var s=r.attributes[a];i[s.name]=s.value}o["common-ui"].configs.chapters.push(i)}},g=function(e){o["common-ui"].configs.thumbs_chapters=[];for(var t=e.querySelectorAll("configs > thumbs_chapters > element"),n=0;n<t.length;n++){for(var r=t[n],i={},a=0;a<r.attributes.length;a++){var s=r.attributes[a];i[s.name]=s.value}o["common-ui"].configs.thumbs_chapters.push(i)}},h=function(t){if(o["common-ui"].configs.transferring=t.querySelector("transferring"),o["common-ui"].configs.transferringVariable="transferring",o["common-ui"].configs.transferring){var r="transferring";return o["common-ui"].configs.transferring.hasAttribute("variable")&&(r=o["common-ui"].configs.transferring.getAttribute("variable")),o["common-ui"].configs.transferringVariable=r,n.transferring=e.Main.urlManager.get(r)||localStorage&&localStorage.getItem(r)||n[r],e.Main.transferring=new e.Class.TransferringManager,function(){return e.Main.transferring.execute(o["common-ui"].configs.transferring,n)}}return null};o["common-ui"].configs={},o["common-ui"].get=r,i(t),a(t),s(t),l(t),u(t),c(t),f(t),p(t),m(t),g(t);var d=h(t);return d}return function(e){var n=Promise.resolve();t(e),r(e),i(e);var o=a(e);return o&&n.then(o),n}}(),"common-configuration":function(t){var n=t.querySelector("contents");o["common-configuration"].config={pageCount:parseInt(n.getAttribute("pages_count"),10),shift:parseInt(n.getAttribute("shift"),10)},o["common-configuration"].contents={};for(var r=t.querySelectorAll("contents > content"),i=0;i<r.length;i++){var a=r[i].getAttribute("id");o["common-configuration"].contents[a]={id:a,width:parseInt(r[i].getAttribute("width")),height:parseInt(r[i].getAttribute("height")),path:this.resolver(r[i].getAttribute("path"))}}o["common-configuration"].get=function(e,t,n){var r=o["common-configuration"][e];return t?(r=r[t],n&&r?r[n]:r?r:null):r?r:null},NIApi.register("page.getCount",function(){return Promise.resolve(e.Main.xmlManager.get("common-configuration","config","pageCount"))})},summary:function(t){o.summary.xml=t,o.summary.get=function(t,n){if("depth"===t){if(0===n)return[];var r=Array.apply(null,Array(n)).map(function(e,t){var n=Array.apply(null,Array(t+1)).map(String.prototype.valueOf,"it");return n.unshift("menu"),n.join(" > ")}),i=e.Main.xmlManager.get("summary","xml").querySelectorAll(r.join(", "));return Array.prototype.map.call(i,function(e){return{page:parseInt(e.getAttribute("p"),10),text:Array.prototype.map.call(e.childNodes,function(e){return"text"===e.nodeName?e.textContent:null}).filter(function(e){return null!==e})[0]}}).sort(function(e,t){return e.page-t.page})}if("xml"===t)return o.summary.xml}},statistics:function s(e){var s=e.querySelector("Statistics");o.statistics.version=parseInt(s.getAttribute("version")||"1",10),o.statistics.servers=s.querySelector("servers"),o.statistics.events=s.querySelector("events"),o.statistics.pages=s.querySelector("pages");var t=s.getAttribute("needConsent");null===t&&(t=!1),o.statistics.needConsent=!!t,o.statistics.get=function(e){return o.statistics[e]}},"combo-pages":function(e){var t=function(e){return parseInt(e.getAttribute("position"),10)},n=e.querySelectorAll('page[type="FILE"][fileType="PDF"]'),r=e.querySelectorAll('page[type="MOVIE"]'),i=[].concat(_toConsumableArray(r)).map(t);o.comboPages.pdfPageIndexes=[].concat(_toConsumableArray(n)).map(t),o.comboPages.scrollablePages=o.comboPages.pdfPageIndexes,o.comboPages.forcedSinglePages=[].concat(_toConsumableArray(o.comboPages.pdfPageIndexes),_toConsumableArray(i)),o.comboPages.get=function(e){return"scrollablePages"===e?o.comboPages.scrollablePages:"forcedSinglePages"===e?o.comboPages.forcedSinglePages:null}}};t.prototype.getVariable=function(e){return n[e]},t.prototype.getVariables=function(){return n},t.prototype.getConsentServices=function(e){var t=Array.prototype.slice.call(e.querySelectorAll("service"));return 0===t.length?["webpublicationStats"]:t.filter(function(e){return"true"===e.getAttribute("enabled")}).map(function(e){return e.getAttribute("name")})},t.prototype.get=function(t,n,r,o){if("common-ui"===t&&"configs"===n&&["viewer","thumbnails","pageLayout"].indexOf(r)>-1)return e.Main[r+"Service"].get(o);var i=this.getProxy(t,n,r,o);return"string"==typeof i?this.resolver(i):i},t.prototype.getProxy=function(e,t,n,r){return"config"===e&&"transferringVariable"===t?"transferring":"config"===e?!(!o.config.get&&"GAStatsEnabled"===t)&&o.config.get(t,n,r):"summary"===e?o.summary.get(t,n,r):"pubinfo"===e?o.pubinfo.get(t,n,r):"common-ui"===e&&"logo"===t?o[e].get&&o[e].get(t,n,r):"undefined"==typeof t?o[e]:o[e].get&&o[e].get(t,n,r)},t.prototype.getXml=function(e){if(r[e])return r[e]},t.prototype.resolver=function(){function e(e,t){return"undefined"!=typeof n[t]?n[t]:e}return function(t){return t?t.replace(/^~\//g,"publication/").replace(/\$([^\$]*)\$/g,e).replace(/\$\{([A-Za-z0-9-_]+)\}/gi,e):t}}(),t.prototype.parse=function(){function t(e){return function(t){var s=this,l=o(t);if(r[e]=l,a.call(this,l),"localeFlash"===e||"locale"===e){var u,c="name",f="string",p="Locale.";"locale"===e&&(c="id",f="message"),u=l.querySelectorAll(f),Array.prototype.forEach.call(u,function(e){var t=e.getAttribute(c),r=e.textContent;n[p+t]=s.resolver(r)});for(var m in n)n[m]=this.resolver(n[m])}var g=i[e].call(this,l);return g instanceof Promise?g:Promise.resolve(!0)}}function o(e){if(e.responseXML)return e.responseXML;var t=new DOMParser;return t.parseFromString(e.responseText,"text/xml")}function a(e){var t=e.getElementsByTagName("variables")[0];if(t){for(var r=t.childNodes,o=0;o<r.length;o++)s.call(this,r[o]);for(var i in n)n[i]=this.resolver(n[i])}}function s(e){if(1===e.nodeType&&e.getAttribute("value")){var t;t=e.getAttribute("id"),n[t]=this.resolver(e.getAttribute("value")),"root"===t&&(n.root="./publication/"),"media"===t&&location.href.indexOf("isApp")>-1&&(n.media=n.media.replace("assets/",""))}}return function(n,r){return e.Utils.promiseXHR("GET",r).then(t(n).bind(this))["catch"](function(e){console.warn(r,e)})}}(),e.Class.XmlManager=t}(webpublicationNamespace),function(w){"use strict";function StartupManager(){}var data={reader:{type:"auto",mode:"3d"},ui:{paging:{mode:["bottom","lateral"],lateral:{hasPrevNext:!0,hasFirstLast:!0,display:"near"}},menu:{mode:["aside","topnav"]},carousel:{mode:["standard"]},zoom:{mode:["doubleclick","pinch"]},theme:{mode:["v4"]}},core:{session:"client",viewer:"v4",viewerDirection:"horizontal",mode:["canvas"],format:["img"]}};StartupManager.prototype._set=function(key,value){for(var splitedKey=key.split("."),finalKey="",i=0;i<splitedKey.length;i++)finalKey+=finalKey?"."+splitedKey[i]:splitedKey[i],eval("data."+finalKey+" = data."+finalKey+" || {};");eval("data."+key+'="'+value+'"')},StartupManager.prototype.start=function(){return w.Utils.promiseXHR("GET","publication/contents/templates/startup.json").then(function(e){return e.responseText&&(data=JSON.parse(e.responseText)),Promise.resolve(!0)})["catch"](function(e){return console&&console.error&&console.error("Failed to load the startup.json. There is probably a syntax error. Message: "+e.toString()),Promise.resolve(!0)})},StartupManager.prototype.get=function(e){var t=null;if(0===e.indexOf("ui.")){var n=w.Param.userAgent.device.type,r=n.charAt(0).toUpperCase()+n.slice(1),o="ui"+r,i=this.get(e.replace(/^ui\./,o+"."));if(null!==i)return i}if("core.verticalArrow.position"===e){var a=this.get("core.verticalArrowPosition");if(a)return a}"core.verticalArrow.display"===e&&(t=["desktop","tablet"]);for(var s=e.split("."),l=data,u=0;u<s.length;u++){if("undefined"==typeof l[s[u]])return t;l=l[s[u]]}return l},StartupManager.prototype.has=function(e,t){var n=this.get(e);return n instanceof Array&&n.indexOf(t)>-1},w.Class.StartupManager=StartupManager}(webpublicationNamespace);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"use strict";function t(){}var n={pagesData:[]};t.prototype.start=function(){var r=e.Main.xmlManager.get("common-ui","assets","configs_json"),o=null;if(r&&(o=e.Utils.resolveVariable(r.url)),!o){var i=!e.Main.startupManager.has("core.format","epub-HTML");if(i)return Promise.resolve(!0);var a="publication/contents/media-epub/script/configs.json";o=a}return e.Utils.promiseXHR("GET",o).then(function(e){return e.responseText&&(n=t.prototype.merge(n,JSON.parse(e.responseText))),Promise.resolve(!0)})["catch"](function(e){return console&&console.error&&console.error("Failed to load the configs.json. There is probably a syntax error. Message: "+e.toString()),Promise.resolve(!0)})},t.prototype.get=function(e){for(var t=e.split("."),r=n,o=0;o<t.length;o++){if("undefined"==typeof r[t[o]])return null;r=r[t[o]]}return r},t.prototype.getPagesData=function(e){var t=this.get("pagesData");if(!t)return null;if(!e)return t;var n=t.map(function(t){var n={};return e.forEach(function(e){n[e]=t[e]}),n});return n},t.prototype.getPageData=function(e,n){var r=t.prototype.getPagesData(e);return r&&r[n]?r[n]:{}},t.prototype.has=function(e,t){var n=this.get(e);return n instanceof Array&&n.indexOf(t)>-1},t.prototype.convertFromPercentIfNeeded=function(e,t){var n=e.toLowerCase().endsWith("opacity");return n&&parseFloat(t)>1?parseFloat(t)/100:t},t.prototype.merge=function(e,t){if(!t)return e;for(var n=JSON.parse(JSON.stringify(e)),r=Object.keys(t),o=0;o<r.length;o++){var i=r[o],a=t[i];if("object"!==("undefined"==typeof a?"undefined":_typeof(a)))n[i]=this.convertFromPercentIfNeeded(i,a);else{var s=Array.isArray(a)?[]:{};n[i]=this.merge(n[i]||s,a)}}return n},NIApi.register("configsJson.getPagesData",function(){return t.prototype.getPagesData()}),NIApi.register("configsJson.setPageData",function(e,r){var o=t.prototype.getPagesData(),i=o&&o[e]?o[e]:{};n.pagesData[e]=t.prototype.merge(i,r),document.dispatchEvent(new CustomEvent("configsJson.pageDataUpdated"))}),e.Class.ConfigsJsonManager=t}(webpublicationNamespace);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function t(){e.Param.viewBody.setAttribute("touch-action","none"),e.Main.templateManager=new e.Class.TemplateManager,e.Param.isLocalReader="http:"!==location.protocol&&"https:"!==location.protocol;var t="file:"===location.protocol||"ms-local-stream:"===location.protocol||"ms-appx:"===location.protocol||"ms-appx-web:"===location.protocol;if(e.Param.isApp=t||e.Main.urlManager.get("isApp"),e.Param.isTouch="ontouchstart"in document.documentElement,this.setMode(),this.createSession(),e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.IE&&e.Param.userAgent.browser.version<11){var r=document.createElement("script");r.type="text/javascript",r.src="global_conf/jquery.js",r.onreadystatechange=function(){"loaded"!==r.readyState&&"complete"!==r.readyState||n.call(this)}.bind(this),document.getElementsByTagName("head")[0].appendChild(r)}else n.call(this)}var n=function(){if(e.Main.startupManager.get("reader.url.flash")&&"flash"===this.mode){var t;try{t=window.ActiveXObject&&new ActiveXObject("ShockwaveFlash.ShockwaveFlash")!==!1}catch(n){t=!1}var r="undefined"!=typeof navigator.plugins&&"object"==_typeof(navigator.plugins["Shockwave Flash"])||t;if(r)return void(location.href=e.Main.startupManager.get("reader.url.flash")+location.search+location.hash)}if("html"===this.mode){var o="reader.url.html"+e.Utils.capitalize(e.Param.userAgent.device.type),i="reader.url.html";if(e.Main.startupManager.get(o))return void(location.href=e.Main.startupManager.get(o)+location.search+location.hash);if(e.Main.startupManager.get(i))return void(location.href=e.Main.startupManager.get(i)+location.search+location.hash)}if(e.Main.templateManager.loadAppend(this.getBody(),e.Param.viewBody),e.Main.templateManager.loadAppend(this.getHead(),e.Param.viewHead),this.mobileSupported===!0)for(var a=document.querySelectorAll(".noflash-mobile"),s=0;s<a.length;s++)a[s].style.display="none"};t.prototype.mode="flash",t.prototype.getBody=function(){return"./global_conf/template/"+this.mode+"/body.html"},t.prototype.getHead=function(){return"./global_conf/template/"+this.mode+"/head.html"},t.prototype.createSession=function(){var t=e.Main.xmlManager.getVariable("client_id"),n=e.Main.xmlManager.getVariable("id"),r=e.Main.startupManager.get("core.session")||"single",o=e.Utils.getCookie("session_"+t),i=t+"_";o=o?o.split(";"):[],"single"===r&&(i=n+i);for(var a=0;a<o.length;a++)if(0===atob(o[a]).indexOf(i))return e.Param.sessionId=o[a],void(e.Param.sessionId=e.Param.sessionId.replace(/=/g,""));
e.Param.sessionId=btoa(i+Math.random().toString().substring(2)),o.push(e.Param.sessionId),e.Param.sessionId=e.Param.sessionId.replace(/=/g,"")},t.prototype.setMode=function(t){"flash"===e.Main.urlManager.get("version")||"flash"===e.Main.startupManager.get("reader.type")?this.mode="flash":e.Main.urlManager.contains("forceMobile")===!0||"html"===e.Main.urlManager.get("version")||"true"===e.Main.urlManager.get("isApp")||"html"===e.Main.startupManager.get("reader.type")?this.mode="html":"undefined"==typeof t?e.Param.userAgent.device.type===e.Param.userAgent.FORMAT.TABLET||e.Param.userAgent.device.type===e.Param.userAgent.FORMAT.PHONE||e.Param.userAgent.device.type===e.Param.userAgent.FORMAT.PHABLET?this.mode="html":this.mode="flash":this.mode=t,this.mobileSupported=!0,e.Param.userAgent.browser.name===e.Param.userAgent.BROWSER.IE&&(e.Param.userAgent.browser.version<=10||"unknown"===e.Param.userAgent.browser.version)&&(this.mode="flash",this.mobileSupported=!1)},t.prototype.rebuild=function(){return this.mode="html",n.call(this)},e.Class.Switcher=t}(webpublicationNamespace),function(e){e.Param.viewBody=document.body,e.Param.viewHead=document.getElementsByTagName("head")[0],e.Param.userAgent=new e.Class.UserAgentManager,e.Param.isDesktop=e.Param.userAgent.isDesktop(),e.Param.isPhone=e.Param.userAgent.isPhone(),e.Param.isTablet=e.Param.userAgent.isTablet(),e.Param.isPhablet=e.Param.userAgent.isPhablet(),e.Param.isUnknown=e.Param.userAgent.isUnknown(),e.Param.supportsPassive=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e.Param.supportsPassive=!0}});window.addEventListener("test",null,t)}catch(n){}return e.Main.startupManager=new e.Class.StartupManager,e.Main.startupManager.start().then(function(){e.Main.urlManager=new e.Class.UrlManager,e.Main.xmlManager=new e.Class.XmlManager;var t=Promise.resolve();t.then(function(){return e.Main.xmlManager.parse("common-configuration",e.Param.pathRoot+"contents/common-configuration.xml").then(function(){return"undefined"==typeof e.Main.xmlManager.getXml("common-configuration")?(console&&console.error&&console.error("No new conf file available, switching to the old model"),e.Main.startupManager._set("reader.configurationVersion",1),Promise.reject()):e.Main.xmlManager.parse("common-ui",e.Param.pathRoot+"contents/templates/common-ui.xml")}).then(function(){return e.Main.configsJsonManager=new e.Class.ConfigsJsonManager,e.Main.configsJsonManager.start()}).then(function(){if(e.Main.xmlManager.getVariable("combo"))return e.Main.xmlManager.parse("combo-pages",e.Param.pathRoot+"contents/media-epub/combo-pages.xml")}).then(function(){e.Main.switcher=new e.Class.Switcher;var t=null;try{t=e.Main.xmlManager.getXml("common-ui").querySelector("template asset[id='statistics']").getAttribute("url")}catch(n){t=e.Main.xmlManager.get("common-configuration","contents","statistics","path")}null===t&&(t=e.Param.pathRoot+"contents/statistics.xml"),t=e.Utils.resolveVariable(t);var r=e.Main.xmlManager.parse("statistics",t);r.then(e.require.bind(e,["../../global_conf/common.js"])).then(function(){2===e.Main.xmlManager.get("statistics","version")&&(e.Main.trackerManager=new e.Class.TrackerManager)})})})["catch"](function(){e.Main.xmlManager.parse("pubinfo",e.Param.pathRoot+"contents/pubinfo.xml").then(function(){return e.Main.xmlManager.parse("contents",e.Main.xmlManager.get("pubinfo","contents"))}).then(function(){return e.Main.xmlManager.parse("template",e.Main.xmlManager.get("pubinfo","template"))}).then(function(){e.Main.switcher=new e.Class.Switcher;var t=null,n=e.Main.xmlManager.getXml("template"),r=n.querySelector("asset[id='statistics']");r&&(t=e.Utils.resolveVariable(r.getAttribute("url"))),t||(t=e.Main.xmlManager.get("pubinfo","statistics")),e.Main.xmlManager.parse("statistics",t).then(e.require.bind(e,["../../global_conf/common.js"])).then(function(){2===e.Main.xmlManager.get("statistics","version")&&(e.Main.trackerManager=new e.Class.TrackerManager)})})})})}(webpublicationNamespace),function(e){"use strict";function t(){}var n={};t.prototype.fetch=function(){var t=e.Main.xmlManager.get("common-ui","assets","common_layout");if(!t)return Promise.resolve(!0);var r=e.Utils.resolveVariable(t.url?t.url:t);e.Utils.promiseXHR("GET",r).then(function(e){return e.responseText&&(n=JSON.parse(e.responseText)),Promise.resolve(!0)})["catch"](function(){return Promise.resolve(!0)})},t.prototype.set=function(e,t){for(var r=e.split("."),o=n,i=0;i<r.length-1;i++)o.hasOwnProperty(r[i])||(o[r[i]]={}),o=o[r[i]];o[r[r.length-1]]=t},t.prototype.get=function(e){for(var t=e.split("."),r=n,o=0;o<t.length;o++){if("undefined"==typeof r[t[o]])return null;r=r[t[o]]}return r},e.Class.CommonLayout=t}(webpublicationNamespace),function(e){function t(){this.config={contentsDepth:0}}function n(e){if(e&&e.hasAttribute("contentsDepth")){var t=e.getAttribute("contentsDepth");this.config.contentsDepth=parseInt(t,10)}}function r(e){t.call(this),n.call(this,e)}var o={contentsDepth:function(){return this.config.contentsDepth}};r.prototype.get=function(e){return o[e].call(this)},r.prototype.set=function(e){for(var t in e)"contentsDepth"===t&&(this.config.contentsDepth=parseInt(e[t],10))},e.Class.ThumbnailsService=r}(webpublicationNamespace),function(e){function t(){return e.Param.isTablet?"tablet":e.Param.isPhone?"phone":e.Param.isDesktop?"desktop":void 0}function n(e){this.viewerConfig={device:t(),rotateClue:null,zoomClick:2,zoomMaxScale:2.5,padding:{portrait:{},landscape:{}}}}function r(t){if(null!==t){var n=this.viewerConfig.device,r=t.querySelector("mode[name="+n+"]");if(r){var o=r.querySelectorAll("padding");Array.prototype.forEach.call(o,function(t){for(var n=this.viewerConfig.padding,r=Object.keys(n.portrait).length>0,o=Object.keys(n.landscape).length>0,i=1;i<c.length;i++){var a=t.getAttribute(c[0]),s=a?a:t.getAttribute(c[i]),l="padding"+e.Utils.capitalize(c[i]);if(s)if(s=parseInt(s,10),t.hasAttribute("orientation")){var u=t.getAttribute("orientation");this.viewerConfig.padding[u][l]=s}else r===!1&&(this.viewerConfig.padding.portrait[l]=s),o===!1&&(this.viewerConfig.padding.landscape[l]=s)}}.bind(this))}}}function o(t){if(null!==t){t.hasAttribute("rotate_clue")&&e.Param.isDesktop===!1&&(this.viewerConfig.rotateClue=t.getAttribute("rotate_clue"));var n=this.viewerConfig.device,r=t.querySelector("mode[name="+n+"]");r&&r.hasAttribute("rotate_clue")&&(this.viewerConfig.rotateClue=r.getAttribute("rotate_clue"))}}function i(n){if(null!==n){var r=this.viewerConfig.device,o=n.querySelector("mode[name="+r+"] zoom");o=o||n.querySelector("mode[name=default] zoom"),o&&o.hasAttribute("clicks")&&(this.viewerConfig.zoomClick=parseInt(o.getAttribute("clicks"),10)),1===this.viewerConfig.zoomClick&&(e.Main.startupManager._set("ui.menu.topnav.display","sticky"),e.Main.startupManager._set("ui"+e.Utils.capitalize(t())+".menu.topnav.display","sticky")),o&&o.hasAttribute("max_scale")&&(this.viewerConfig.zoomMaxScale=o.getAttribute("max_scale"))}}function a(e){l.call(this,e,"page")}function s(e){l.call(this,e,"popup")}function l(e,t){var n=this;if(null!==e){var r=this.viewerConfig.device,o=e.querySelector("mode[name="+r+"] "+t);o=o||e.querySelector("mode[name=default] "+t),null!==o&&Array.prototype.forEach.call(o.attributes,function(e){n.viewerConfig[t+"_"+e.localName]=e.value})}}function u(e){n.call(this,e),r.call(this,e),o.call(this,e),i.call(this,e),a.call(this,e),s.call(this,e)}var c=["all","top","right","left","bottom"],f={paddingTop:0,paddingRight:0,paddingLeft:0,paddingBottom:0};u.prototype.get=function(t,n){return t=e.Utils.capitalize(t),this["get"+t](n)},u.prototype.getPadding=function(){var t={},n=e.Param.isPortrait?"portrait":"landscape";for(var r in f)t[r]=f[r];for(var o in this.viewerConfig.padding[n])t[o]=this.viewerConfig.padding[n][o];return t},u.prototype.getRotateClue=function(){return this.viewerConfig.rotateClue},u.prototype.getZoom=function(e){return"click"===e?this.viewerConfig.zoomClick:"max-scale"===e?this.viewerConfig.zoomMaxScale:null},u.prototype.getPage=function(e){return this.viewerConfig["page_"+e]},u.prototype.getPopup=function(e){return this.viewerConfig["popup_"+e]},u.prototype.set=function(e){for(var t in e)if(0===t.indexOf("padding")){var n=this.viewerConfig.padding;n.portrait[t]=n.portrait[t]||e[t],n.landscape[t]=n.landscape[t]||e[t]}else this.viewerConfig[t]=e[t]},e.Class.ViewerService=u}(webpublicationNamespace),function(e){function t(e){this.config={pageLayout:"auto",pagesOnFirstFrame:1}}function n(t){if(null!==t&&t.hasAttribute("first_frame")){var n=t.getAttribute("first_frame");e.Utils._assertInteger(n,"Page number must be an integer")&&(this.config.pagesOnFirstFrame=parseInt(n,10))}}function r(e){if(null!==e&&e.hasAttribute("value")){var t=e.getAttribute("value");this.config.pageLayout=""===t?"auto":t}}function o(e){t.call(this,e),n.call(this,e),r.call(this,e)}o.prototype.getPageLayout=function(){return this.config.pageLayout},o.prototype.getPagesOnFirstFrame=function(){return this.config.pagesOnFirstFrame},o.prototype.get=function(t){return t=e.Utils.capitalize(t),this["get"+t]()},o.prototype.set=function(e){for(var t in e)this.viewerConfig[t]=e[t]},e.Class.PageLayoutService=o}(webpublicationNamespace);